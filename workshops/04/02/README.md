# Группа 2. Сбор данных с IoT-датчиков

## Контекст задачи

Компания "SmartHome" производит датчики и ПО для умного дома.

### Сущности

1. *Датчик* - устройство, которое собирает показатели и отправляет на сервер обработки данных
    - Идентификатор
    - Тип
        - Датчик протечки (*leak*)
        - Датчик углекисого газа (CO2)
        - Температура воздуха
        - Определитель влажности

2. *Локация* - место на карте, где установили датчик
    - Идентфикатор
    - Адрес

3. **Пользователь** - человек, который пользуется датчиками
    - Идентификатор
    - ФИО

4. **Фиксация показателей** - событие передачи показателей датчика
    - Используемый датчик
    - Локация
    - Пользователь
    - Тип
    - Время события
    - Значение показателя

## Задание

> Пункты с ❗️ - обязательные к выполнению

1. Cпроектировать схему хранения, которая позволяет:
    - ❗️Хранить показания, поступающие с датчиков
    - ❗️Просматривать **историю** их значений

2. **Подготовить запросы/выборки**:  
    - ❗️Видеть текущие показатели датчиков по локациям
    - У кого были протечки за последнию неделю
    - В каких локациях уровень CO2 превысил *500* за последние 3 (три) дня
    - Определить возгорание в локации (CO2 >= 500 и t > 100)

> ❗️⚡️ Реализовать шардирование и выбрать оптимальный ключ распределения

### Чек-лист сдачи задания

1. DDL всех таблиц с устным пояснением  
2. DML: 5–10 событий, демонстрирующих ключевые сценарии  
3. SELECT-запросы
4. Обосновать выбранные подходы:
    - какие подходы хранения истории использованы  
    - плюсы и минусы модели  
    - как выбранная схема упрощает или усложняет работу с данными

### Вспомогательные материалы

- [Документация про Distributed Table (шардирование)](https://clickhouse.com/docs/ru/engines/table-engines/special/distributed)
- [Создание таблиц](https://clickhouse.com/docs/ru/sql-reference/statements/create/table)
- [Вставка данных в таблицы](https://clickhouse.com/docs/ru/sql-reference/statements/insert-into)
- [Джоины таблиц](https://clickhouse.com/docs/ru/sql-reference/statements/select/join)
