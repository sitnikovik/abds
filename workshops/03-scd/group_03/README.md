# Группа 3. Стриминг: подписки и просмотры

## Контекст задачи

Онлайн-кинотеатр "КиноПлюс" хочет отслеживать поведение пользователей и их подписки, чтобы улучшать рекомендации, работу с контентом и удержание клиентов.  

У каждого пользователя есть:

- информация о подписке (id, дата начала, дата окончания, тип подписки)
- история просмотров (id фильма, дата, длительность просмотра)
- статус подписки (активна, приостановлена, отменена)
- тип контента (фильмы, сериалы, документальные)
- устройство, с которого осуществляется просмотр

Бизнес-задачи:

1. Понимать текущий статус подписки каждого пользователя
2. Отслеживать историю подписок и просмотров
3. Собирать статистику по просмотрам: что и когда смотрят, сколько времени проводят
4. Анализировать поведение при изменении подписки (приостановка, отмена, продление)

## Возможные бизнес-сценарии

1. **Начало подписки**  
   - Пользователь оформил подписку на месяц или год  
   - Важно фиксировать дату начала и тип подписки

2. **Продление подписки**  
   - Пользователь продлевает подписку или меняет её тип  
   - Нужно сохранить историю изменений, чтобы видеть, какие тарифы выбирали чаще

3. **Приостановка подписки**  
   - Пользователь замораживает подписку на время (например, отпуск)  
   - Необходимо хранить причину и период приостановки

4. **Отмена подписки**  
   - Пользователь решил отказаться  
   - Важно знать дату отмены и причину (если есть)

5. **Просмотры фильмов/серий**  
   - Пользователь смотрит контент  
   - Нужно фиксировать историю просмотров, длительность и тип контента

6. **Повторные просмотры**  
   - Пользователь может пересматривать фильмы  
   - История просмотров должна хранить все события, чтобы анализировать привычки

## Что требуется

1. Построить схему хранения данных так, чтобы:

   - можно было видеть текущий статус подписки  
   - можно было проследить всю историю изменений подписок и просмотров  
   - можно было анализировать поведение пользователей по времени и типам контента  

2. Сохранить возможность в будущем быстро отвечать на вопросы:

   - Сколько пользователей продлили подписку в этом месяце?  
   - Какие фильмы/сериалы смотрят чаще всего в разных типах подписок?  
   - Сколько времени в среднем проводят пользователи на платформе?  
   - Как часто пользователи приостанавливают подписку и на какой период?  

3. Подготовить SQL-структуру таблиц и продумать механизм фиксации изменений  

4. Обосновать свой выбор:

   - Какие стратегии хранения истории вы выбрали (какие типы SCD)?  
   - Почему именно так?  
   - Какие плюсы и минусы у вашего решения?  

## Чек-лист сдачи задания

1. DDL всех таблиц и объяснение, зачем каждая нужна  
2. Несколько INSERT-ов, демонстрирующих кейсы: начало подписки, продление, приостановка, отмена, просмотры, повторные просмотры  
3. SELECT-запросы: current view, история подписок, хронология просмотров, статистика по времени и типам контента  
4. Короткое обоснование выбора хранения истории (какие SCD использованы, почему)